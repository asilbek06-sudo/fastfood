<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Магазин еды и воды — адаптивный и стильный</title>
  <style>
        * {
          box-sizing: border-box;
        }
        body {
          margin: 0;
          padding: 20px;
          font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
          background: linear-gradient(135deg, #e0f7fa, #80deea);
          color: #004d40;
          min-height: 100vh;
          display: flex;
          flex-direction: column;
          align-items: center;
        }
        h1 {
          font-size: 2.8rem;
          font-weight: 800;
          margin-bottom: 10px;
          text-align: center;
          color: #00796b;
          text-shadow: 1px 1px 4px #a5d6a7;
          user-select: none;
        }

        /* Кнопка открытия корзины */
        #open-cart {
          position: fixed;
          top: 20px;
          right: 20px;
          background: linear-gradient(135deg, #26a69a, #004d40);
          color: white;
          border: none;
          padding: 14px 26px;
          font-weight: 700;
          border-radius: 50px;
          cursor: pointer;
          box-shadow: 0 8px 20px rgba(38, 166, 154, 0.6);
          display: flex;
          align-items: center;
          gap: 10px;
          font-size: 1.15rem;
          user-select: none;
          transition: box-shadow 0.3s ease, transform 0.25s ease;
          z-index: 1001;
        }
        #open-cart:hover {
          box-shadow: 0 12px 30px rgba(38, 166, 154, 0.85);
          transform: translateY(-3px);
        }
        #open-cart:active {
          transform: translateY(0);
          box-shadow: 0 6px 15px rgba(38, 166, 154, 0.5);
        }
        #open-cart svg {
          width: 26px;
          height: 26px;
          fill: white;
          animation: pulse 1.8s infinite ease-in-out;
        }
        @keyframes pulse {
          0%, 100% { transform: scale(1); }
          50% { transform: scale(1.15); }
        }
        #cart-count {
          background: #d32f2f;
          color: white;
          font-weight: 700;
          border-radius: 15px;
          padding: 3px 10px;
          font-size: 0.9rem;
          box-shadow: 0 2px 6px rgba(0,0,0,0.25);
          user-select: none;
        }

        /* Контейнер товаров */
        .products {
          display: grid;
          grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
          gap: 30px;
          width: 100%;
          max-width: 1024px;
          margin-top: 70px;
          padding-bottom: 40px;
        }

        /* Карточка продукта */
        .product-card {
          background: linear-gradient(145deg, #ffffff, #a7ffeb);
          border-radius: 20px;
          box-shadow:
            8px 8px 15px #80cbc4,
            -8px -8px 15px #e0f2f1;
          padding: 20px 16px 30px;
          display: flex;
          flex-direction: column;
          align-items: center;
          transition: transform 0.35s cubic-bezier(0.25, 1, 0.5, 1), box-shadow 0.3s ease;
          cursor: pointer;
          user-select: none;
        }
        .product-card:hover {
          transform: scale(1.07);
          box-shadow:
            12px 12px 25px #4db6ac,
            -12px -12px 25px #b2dfdb,
            0 0 18px 4px #00897b;
          border: 2px solid #00897b;
        }

        .product-card img {
          width: 140px;
          height: 140px;
          border-radius: 18px;
          object-fit: cover;
          margin-bottom: 18px;
          box-shadow: 0 6px 10px rgba(0,0,0,0.15);
          user-select: none;
        }

        .product-name {
          font-weight: 800;
          font-size: 1.3rem;
          margin-bottom: 8px;
          color: #004d40;
          text-align: center;
        }

        .product-price {
          font-size: 1.15rem;
          color: #00796b;
          margin-bottom: 20px;
          font-weight: 600;
        }

        .buy-button {
          background: #00796b;
          border: none;
          padding: 14px 26px;
          border-radius: 50px;
          color: white;
          font-weight: 700;
          font-size: 1rem;
          box-shadow: 0 6px 16px rgba(0, 121, 107, 0.6);
          transition: background 0.3s ease, transform 0.25s ease, box-shadow 0.3s ease;
          cursor: pointer;
          user-select: none;
        }
        .buy-button:hover {
          background: #004d40;
          box-shadow: 0 9px 24px rgba(0, 77, 64, 0.8);
          transform: translateY(-2px);
        }
        .buy-button:active {
          transform: translateY(0);
          box-shadow: 0 5px 12px rgba(0, 77, 64, 0.7);
        }
        .buy-button:disabled {
          background: #80cbc4;
          cursor: default;
          box-shadow: none;
        }

        /* Панель корзины */
        #cart-panel {
          position: fixed;
          top: 0;
          right: -400px;
          width: 400px;
          max-width: 100vw;
          height: 100vh;
          background: rgba(255 255 255 / 0.95);
          backdrop-filter: blur(16px);
          border-left: 3px solid #00897b;
          box-shadow: -4px 0 24px rgba(0,0,0,0.15);
          padding: 30px 20px;
          overflow-y: auto;
          transition: right 0.4s cubic-bezier(0.4, 0, 0.2, 1);
          z-index: 1000;
          display: flex;
          flex-direction: column;
        }
        #cart-panel.open {
          right: 0;
        }
        #cart-panel h2 {
          text-align: center;
          font-size: 2rem;
          font-weight: 900;
          margin-bottom: 25px;
          color: #004d40;
          user-select: none;
        }

        /* Список корзины */
        #cart-items {
          list-style: none;
          padding: 0;
          margin: 0 0 25px 0;
          flex-grow: 1;
          overflow-y: auto;
        }
        #cart-items li {
          background: #b2dfdb;
          color: #004d40;
          font-weight: 700;
          padding: 12px 18px;
          margin-bottom: 14px;
          border-radius: 12px;
          display: flex;
          justify-content: space-between;
          align-items: center;
          box-shadow: inset 2px 2px 10px #80cbc4;
          user-select: none;
        }
        .remove-button {
          background: #d32f2f;
          border: none;
          color: white;
          padding: 6px 14px;
          font-weight: 700;
          border-radius: 10px;
          cursor: pointer;
          transition: background 0.3s ease;
          user-select: none;
        }
        .remove-button:hover {
          background: #9a0007;
        }
        .remove-button:active {
          background: #7b0005;
        }

        /* Кнопка оформления */
        .checkout-button {
          background: #43a047;
          border: none;
          padding: 18px 0;
          border-radius: 30px;
          font-size: 1.3rem;
          font-weight: 900;
          color: white;
          cursor: pointer;
          box-shadow: 0 8px 22px rgba(67, 160, 71, 0.7);
          transition: background 0.3s ease, transform 0.25s ease;
          user-select: none;
        }
        .checkout-button:hover {
          background: #2e7d32;
          transform: translateY(-3px);
        }
        .checkout-button:active {
          transform: translateY(0);
          box-shadow: 0 5px 12px rgba(46, 125, 50, 0.7);
        }

        /* Кнопка закрытия корзины */
        #close-cart {
          margin-top: 20px;
          padding: 12px 0;
          background: #00796b;
          border: none;
          border-radius: 20px;
          color: white;
          font-weight: 700;
          font-size: 1.1rem;
          cursor: pointer;
          transition: background 0.3s ease, transform 0.2s ease;
          user-select: none;
        }
        #close-cart:hover {
          background: #004d40;
          transform: translateY(-2px);
        }
        #close-cart:active {
          transform: translateY(0);
        }

        /* Итоговая сумма */
        #total {
          font-size: 1.3rem;
          font-weight: 800;
          text-align: right;
          margin-bottom: 15px;
          color: #00796b;
          user-select: none;
        }

        /* Адаптивность */
        @media (max-width: 600px) {
          #open-cart {
            top: 12px;
            right: 12px;
            padding: 12px 20px;
            font-size: 1rem;
          }
          #open-cart svg {
            width: 22px;
            height: 22px;
          }
          #cart-panel {
            width: 100vw;
            max-width: 100vw;
            border-left: none;
            border-top: 3px solid #00897b;
            bottom: 0;
            height: 60vh;
            right: -100vw;
            border-radius: 20px 20px 0 0;
            padding: 20px 15px;
          }
          #cart-panel.open {
            right: 0;
          }
          .products {
            grid-template-columns: repeat(auto-fit, minmax(160px, 1fr));
            gap: 20px;
            margin-top: 60px;
            padding-bottom: 60px;
          }
          .product-card img {
            width: 110px;
            height: 110px;
          }
          .buy-button {
            padding: 12px 20px;
            font-size: 0.9rem;
          }
          #total {
            font-size: 1.1rem;
          }
          .checkout-button {
            font-size: 1.1rem;
            padding: 14px 0;
          }
        }
    </style>
</head>
<body>

<h1>Магазин еды и воды</h1>

<button id="open-cart" aria-label="Открыть корзину">
    <svg viewBox="0 0 24 24" aria-hidden="true" focusable="false" xmlns="http://www.w3.org/2000/svg">
        <path d="M7 18c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm10 0c-1.104 0-2 .896-2 2s.896 2 2 2 2-.896 2-2-.896-2-2-2zm-12.83-2.28L4 10H20v2H6.21l-1.04 3.72zM20.705 8.29l-1.367 4.89H6.97l.08-.31L4.9 5H2v-2h3a1 1 0 0 1 .965.74L7.2 8H20v2h.705z"/>
    </svg>
    Корзина <span id="cart-count">0</span>
</button>

<div class="products">
    <div class="product-card" data-name="Вода" data-price="150">
        <img src="https://images.unsplash.com/photo-1501004318641-b39e6451bec6?auto=format&fit=crop&w=140&q=80"
             alt="Вода"/>
        <div class="product-name">Вода</div>
        <div class="product-price">150 ТГ</div>
        <button class="buy-button">Купить</button>
    </div>
    <div class="product-card" data-name="Яблоко" data-price="250">
        <img src="https://images.unsplash.com/photo-1567306226416-28f0efdc88ce?auto=format&fit=crop&w=140&q=80"
             alt="Яблоко"/>
        <div class="product-name">Яблоко</div>
        <div class="product-price">250 ТГ</div>
        <button class="buy-button">Купить</button>
    </div>
    <div class="product-card" data-name="Банан" data-price="350">
        <img src="https://images.unsplash.com/photo-1574226516831-e1dff420e42e?auto=format&fit=crop&w=140&q=80"
             alt="Банан"/>
        <div class="product-name">Банан</div>
        <div class="product-price">350 ТГ</div>
        <button class="buy-button">Купить</button>
    </div>
</div>

<div id="cart-panel" role="dialog" aria-modal="true" aria-labelledby="cart-title">
    <h2 id="cart-title">Корзина</h2>
    <ul id="cart-items"></ul>
    <div id="total">Итого: 0 ТГ</div>
    <button class="checkout-button" id="checkout">Оформить заказ</button>
    <button id="close-cart" aria-label="Закрыть корзину">Закрыть</button>
</div>

<audio id="add-sound" src="https://actions.google.com/sounds/v1/cartoon/wood_plank_flicks.ogg" preload="auto"></audio>

<script>
    const products = document.querySelectorAll('.product-card');
    const openCartBtn = document.getElementById('open-cart');
    const closeCartBtn = document.getElementById('close-cart');
    const cartPanel = document.getElementById('cart-panel');
    const cartItemsEl = document.getElementById('cart-items');
    const totalEl = document.getElementById('total');
    const checkoutBtn = document.getElementById('checkout');
    const cartCountEl = document.getElementById('cart-count');
    const addSound = document.getElementById('add-sound');

    // Загружаем корзину из localStorage или создаём пустую
    let cart = JSON.parse(localStorage.getItem('cart')) || [];

    function saveCart() {
        localStorage.setItem('cart', JSON.stringify(cart));
    }

    function updateCartUI() {
        cartItemsEl.innerHTML = '';
        let total = 0;
        cart.forEach((item, index) => {
            total += item.price * item.quantity;

            const li = document.createElement('li');
            li.textContent = `${item.name} — ${item.price} ТГ × ${item.quantity}`;

            const removeBtn = document.createElement('button');
            removeBtn.textContent = 'Удалить';
            removeBtn.className = 'remove-button';
            removeBtn.onclick = () => {
                cart.splice(index, 1);
                saveCart();
                updateCartUI();
                updateCartCount();
            };

            li.appendChild(removeBtn);
            cartItemsEl.appendChild(li);
        });

        totalEl.textContent = `Итого: ${total} ТГ`;
        updateCartCount();
    }

    function updateCartCount() {
        const count = cart.reduce((acc, item) => acc + item.quantity, 0);
        cartCountEl.textContent = count;
    }

    function animateAddToCart(img, callback) {
        const imgRect = img.getBoundingClientRect();
        const cartRect = openCartBtn.getBoundingClientRect();

        const flyingImg = img.cloneNode(true);
        flyingImg.style.position = 'fixed';
        flyingImg.style.left = `${imgRect.left}px`;
        flyingImg.style.top = `${imgRect.top}px`;
        flyingImg.style.width = `${imgRect.width}px`;
        flyingImg.style.height = `${imgRect.height}px`;
        flyingImg.style.borderRadius = '18px';
        flyingImg.style.transition = 'all 0.8s cubic-bezier(0.4, 0, 0.2, 1)';
        flyingImg.style.zIndex = 1500;
        flyingImg.style.pointerEvents = 'none';
        document.body.appendChild(flyingImg);

        requestAnimationFrame(() => {
            flyingImg.style.left = `${cartRect.left + cartRect.width / 2 - imgRect.width / 4}px`;
            flyingImg.style.top = `${cartRect.top + cartRect.height / 2 - imgRect.height / 4}px`;
            flyingImg.style.width = `${imgRect.width / 2}px`;
            flyingImg.style.height = `${imgRect.height / 2}px`;
            flyingImg.style.opacity = '0.5';
        });

        flyingImg.addEventListener('transitionend', () => {
            flyingImg.remove();
            if (callback) callback();
        }, { once: true });
    }

    function addToCart(name, price) {
        const existing = cart.find(item => item.name === name);
        if (existing) {
            existing.quantity += 1;
        } else {
            cart.push({ name, price, quantity: 1 });
        }
        saveCart();
        updateCartUI();
        updateCartCount();

        // Звук добавления
        addSound.currentTime = 0;
        addSound.play();
    }

    products.forEach(card => {
        const btn = card.querySelector('.buy-button');
        const img = card.querySelector('img');
        btn.addEventListener('click', () => {
            btn.disabled = true;
            animateAddToCart(img, () => {
                const name = card.dataset.name;
                const price = parseInt(card.dataset.price);
                addToCart(name, price);
                btn.textContent = 'Добавлено!';
                setTimeout(() => {
                    btn.textContent = 'Купить';
                    btn.disabled = false;
                }, 1200);
            });
        });
    });

    openCartBtn.addEventListener('click', () => {
        cartPanel.classList.add('open');
    });

    closeCartBtn.addEventListener('click', () => {
        cartPanel.classList.remove('open');
    });

    checkoutBtn.addEventListener('click', () => {
        if (cart.length === 0) {
            alert('Ваша корзина пуста!');
            return;
        }
        alert('Спасибо за заказ! Мы свяжемся с вами.');
        cart = [];
        saveCart();
        updateCartUI();
        cartPanel.classList.remove('open');
    });

    // Обновляем интерфейс корзины при загрузке страницы
    updateCartUI();

</script>
</body>
</html>
